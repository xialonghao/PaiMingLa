webpackJsonp([7],{"9o8L":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("pyVz"),a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"personalCenter"}},[i("div",{staticClass:"conBoxBorder"},[i("h3",{staticClass:"title"},[e._v("个人中心")]),e._v(" "),i("el-form",{ref:"form",staticClass:"from",attrs:{model:e.form,rules:e.passwordRules,"label-width":"100px"}},[i("el-form-item",{staticClass:"inputWidth",attrs:{label:"用户名："}},[i("el-input",{model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName","string"==typeof t?t.trim():t)},expression:"form.userName"}})],1),e._v(" "),i("el-form-item",{staticClass:"inputWidth",attrs:{label:"头像："}},[i("img",{staticClass:"head",attrs:{src:"http://pml.zhihuo.com.cn"+e.form.headImg,alt:""}}),e._v(" "),i("div",{staticClass:"headTxt"},[i("label",[i("input",{staticStyle:{display:"none"},attrs:{type:"file",accept:"image/png,image/jpeg"},on:{change:e.updateHead}}),e._v(" "),i("p",[e._v("+选择上传")])]),e._v(" "),i("p",[e._v("支持格式:jpg、png;建议尺寸:120*120")])])]),e._v(" "),i("el-form-item",{staticClass:"inputWidth",attrs:{label:"修改密码：",prop:"passWord"}},[i("el-input",{attrs:{placeholder:"输入新密码"},on:{change:e.passWordReg},model:{value:e.form.passWord,callback:function(t){e.$set(e.form,"passWord","string"==typeof t?t.trim():t)},expression:"form.passWord"}}),e._v(" "),i("div",{staticClass:"tip"},[e._v("*为空表示不修改密码")])],1),e._v(" "),i("el-form-item",{staticClass:"inputWidth",attrs:{label:"确认密码：",prop:"passWordReg"}},[i("el-input",{attrs:{placeholder:"再次输入密码"},model:{value:e.form.passWordReg,callback:function(t){e.$set(e.form,"passWordReg","string"==typeof t?t.trim():t)},expression:"form.passWordReg"}})],1),e._v(" "),i("el-form-item",{staticClass:"inputWidth",attrs:{label:"绑定手机："}},[i("el-input",{attrs:{disabled:""},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile","string"==typeof t?t.trim():t)},expression:"form.mobile"}}),e._v(" "),i("div",{staticClass:"tip"},[i("span",{staticClass:"modification",on:{click:function(t){e.dialogVisible=!0,e.active=1}}},[e._v("*修改")])])],1),e._v(" "),i("el-form-item",{staticClass:"inputWidth",attrs:{label:"绑定邮箱："}},[i("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email","string"==typeof t?t.trim():t)},expression:"form.email"}})],1),e._v(" "),i("el-form-item",{staticClass:"inputWidth",attrs:{label:"绑定微信号："}},[i("img",{staticClass:"qr",attrs:{src:s("dLd/"),alt:""}}),e._v(" "),i("div",{staticClass:"qrDescribe"},[e._v("\n          请使用微信扫描二维吗\n        ")])]),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.userSubmit("form")}}},[e._v("保存")]),e._v(" "),i("el-button",{on:{click:e.getData}},[e._v("取消")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"修改手机",visible:e.dialogVisible,width:"30%","before-close":e.mobile},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},[i("el-step",{attrs:{title:"验证身份"}}),e._v(" "),i("el-step",{attrs:{title:"修改手机"}}),e._v(" "),i("el-step",{attrs:{title:"完成修改"}})],1),e._v(" "),0===e.active?i("div",{staticClass:"stepsCon"},[i("div",{staticClass:"stepsH"},[i("p",[e._v("为了保证您的账号安全，更换绑定手机前请先进行验证")]),e._v(" "),i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[i("el-form-item",{staticStyle:{"text-align":"left",margin:"10px 0"},attrs:{label:"原手机：",prop:"mobile"}},[e._v("\n              "+e._s(e.ruleForm.mobile.replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2"))+"\n            ")]),e._v(" "),i("el-form-item",{staticClass:"verify",attrs:{label:"验证码：",prop:"verify"}},[i("el-input",{model:{value:e.ruleForm.verify,callback:function(t){e.$set(e.ruleForm,"verify","string"==typeof t?t.trim():t)},expression:"ruleForm.verify"}}),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.sendCode}},[e._v(e._s(e.countDown))])],1)],1)],1),e._v(" "),i("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:function(t){return e.oneForm("ruleForm")}}},[e._v("下一步")]),e._v(" "),i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1):e._e(),e._v(" "),1===e.active?i("div",{staticClass:"stepsCon"},[i("div",{staticClass:"stepsH"},[i("el-form",{ref:"upForm",staticClass:"demo-ruleForm",attrs:{model:e.upForm,rules:e.uprules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"手机号码：",prop:"mobileNum"}},[i("el-input",{model:{value:e.upForm.mobileNum,callback:function(t){e.$set(e.upForm,"mobileNum","string"==typeof t?t.trim():t)},expression:"upForm.mobileNum"}})],1),e._v(" "),i("el-form-item",{staticClass:"verify",attrs:{label:"验证码：",prop:"verify"}},[i("el-input",{model:{value:e.upForm.verify,callback:function(t){e.$set(e.upForm,"verify","string"==typeof t?t.trim():t)},expression:"upForm.verify"}}),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.upSendCode}},[e._v(e._s(e.countDown2))])],1)],1)],1),e._v(" "),i("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:function(t){return e.twoForm("upForm")}}},[e._v("下一步")]),e._v(" "),i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1):e._e(),e._v(" "),2===e.active?i("div",{staticClass:"stepsCon"},[i("div",{staticClass:"stepsH"},[i("i",{staticClass:"el-icon-success succeedIcon"}),e._v(" "),i("span",{staticClass:"succeed"},[e._v("恭喜您，修改成功！")])]),e._v(" "),i("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1):e._e()],1)],1)])},staticRenderFns:[]};var o=function(e){s("aqiB")},r=s("VU/8")(i.a,a,!1,o,"data-v-7c08dc22",null);t.default=r.exports},aqiB:function(e,t){},pyVz:function(e,t,s){"use strict";(function(e){t.a={name:"PersonalCenter",data:function(){return{form:{userName:"",passWord:"",passWordReg:"",mobile:"",email:"",headImg:""},passwordRules:{passWord:[{min:6,message:"密码长度不小于六位数",trigger:"blur"}],passWordReg:[{required:!1,pattern:"",message:"两次输入的密码不一样",trigger:"blur"}]},dialogVisible:!1,active:0,ruleForm:{mobile:"",verify:""},rules:{verify:[{required:!0,message:"请输入手机收到的验证码",trigger:"blur"}]},countDown:"获取验证码",btnSendNote:!0,upForm:{mobileNum:"",verify:""},uprules:{mobileNum:[{required:!0,message:"请输入新的手机号码",trigger:"blur"},{pattern:/^1[34578]\d{9}$/,message:"目前只支持中国大陆的手机号码",trigger:"blur"}],verify:[{required:!0,message:"请输入手机收到的验证码",trigger:"blur"}]},countDown2:"获取验证码",btnSendNote2:!0}},methods:{passWordReg:function(){this.passwordRules.passWordReg[0].pattern=new RegExp("^"+this.form.passWord+"$"),this.form.passWord.length>0?this.passwordRules.passWordReg[0].required=!0:this.passwordRules.passWordReg[0].required=!1},updateHead:function(e){var t=this,s=e.target.files[0],i=new FormData;i.append("file",s),i.append("token",document.cookie.match(/token=(.*?)(;|$)/)[1]),this.$axios.create({withCredentials:!0}).post("http://pml.zhihuo.com.cn/api/common/upload",i).then(function(e){t.form.headImg=e.data.data.url})},getData:function(){var e=this;this.$axios.post("http://pml.zhihuo.com.cn/api/user/get_userinfo",this.$qs.stringify({token:document.cookie.match(/token=(.*?)(;|$)/)[1]})).then(function(t){e.form.userName=t.data.data.username,e.form.mobile=t.data.data.mobile.replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2"),e.form.email=t.data.data.email,e.form.headImg=t.data.data.avatar,e.ruleForm.mobile=t.data.data.mobile,e.ruleForm.email=t.data.data.email})},userSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message.error("错了哦，密码填写有误"),!1;t.$confirm("确定要修改吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("http://pml.zhihuo.com.cn/api/user/profile",t.$qs.stringify({token:document.cookie.match(/token=(.*?)(;|$)/)[1],username:t.form.userName,avatar:t.form.headImg,password:t.form.passWord,email:t.form.email})).then(function(e){"Successful"===e.data.msg?t.$message({type:"success",message:"修改成功!"}):t.$message({type:"info",message:"修改失败"})})}).catch(function(){t.$message({type:"info",message:"修改失败"})})})},mobile:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},oneForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.$axios.post("http://pml.zhihuo.com.cn/api/user/changemobile",t.$qs.stringify({token:document.cookie.match(/token=(.*?)(;|$)/)[1],mobile:t.ruleForm.mobile,captcha:t.ruleForm.verify})).then(function(e){"Successful"===e.data.msg?t.active++>2&&(t.active=0):t.$message.error("验证码错误")})})},sendCode:function(){var e=this;this.btnSendNote&&this.$axios.post("http://pml.zhihuo.com.cn/api/sms/send",this.$qs.stringify({mobile:this.ruleForm.mobile,event:"changemobile"})).then(function(t){if("发送成功"===t.data.msg){e.btnSendNote=!1;var s=60;e.countDown=s+"s重新获取";var i=setInterval(function(){0===s?(clearInterval(i),e.countDown="获取验证码",e.btnSendNote=!0):(s--,e.countDown=s+"s重新获取")},1e3);e.$message({message:"发送成功",type:"success"})}else e.$message({message:t.data.msg,type:"warning"})})},twoForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.$axios.post("http://pml.zhihuo.com.cn/api/user/changemobile",t.$qs.stringify({token:document.cookie.match(/token=(.*?)(;|$)/)[1],mobile:t.upForm.mobileNum,captcha:t.upForm.verify})).then(function(e){"Successful"===e.data.msg?(t.active++>2&&(t.active=0),t.getData()):t.$message.error("验证码错误")})})},upSendCode:function(){var e=this;this.btnSendNote2&&this.$axios.post("http://pml.zhihuo.com.cn/api/sms/send",this.$qs.stringify({mobile:this.upForm.mobileNum,event:"changemobile"})).then(function(t){if("发送成功"===t.data.msg){e.btnSendNote2=!1;var s=60;e.countDown2=s+"s重新获取";var i=setInterval(function(){0===s?(clearInterval(i),e.countDown2="获取验证码",e.btnSendNote2=!0):(s--,e.countDown2=s+"s重新获取")},1e3);e.$message({message:"发送成功",type:"success"})}else e.$message({message:t.data.msg,type:"warning"})})}},mounted:function(){this.getData();setInterval(function(){e(".verify .el-input").css({width:"40%",float:"left"})},10)}}}).call(t,s("7t+N"))},xK8U:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={render:function(){var e=this.$createElement;return(this._self._c||e)("router-view")},staticRenderFns:[]};var a=s("VU/8")({name:"IndexFinancialCenter"},i,!1,function(e){s("y2yL")},"data-v-ef1fb464",null);t.default=a.exports},y2yL:function(e,t){}});